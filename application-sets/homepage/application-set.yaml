apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: homepage-application-set
  namespace: argocd
spec:
  template:
    metadata:
      name: '{{cluster}}-homepage'
    spec:
      source:
        repoURL: https://jameswynn.github.io/helm-charts
        targetRevision: 1.2.3
        chart: homepage
        helm:
          valuesObject:
            image:
              repository: ghcr.io/gethomepage/homepage
              tag: latest
            config:
              settings:
                title: Matheus Barbieri HomePage
                background: https://images.unsplash.com/photo-1502790671504-542ad42d5189?auto=format&fit=crop&w=2560&q=80
              bookmarks:
                - Developer:
                    - Github:
                        - abbr: gh
                          href: https://github.com/
                    - Gitlab:
                        - abbr: gl
                          href: http://gitlab.colmeia.me/
                    - Google Cloud:
                        - abbr: gcp
                          href: https://console.cloud.google.com/
              services:
                - Personal:
                    - ArgoCD:
                        href: https://argocd.kube.msbarbieri.dev/
                        description: ArgoCD
                        icon: https://miro.medium.com/v2/resize:fit:1400/1*d_nWfpG-EF831-yXwx64HQ.png
                        app: argocd-server
                        namespace: argocd
                - Colmeia:
                    - gitlab:
                        href: http://gitlab.colmeia.me/
                        description: gitlab da colmeia
                    - google:
                        href: https://console.cloud.google.com/
                        description: console de gcp
              widgets:
                # show the kubernetes widget, with the cluster summary and individual nodes
                - kubernetes:
                    cluster:
                      show: true
                      cpu: true
                      memory: true
                      showLabel: true
                      label: "cluster"
                    nodes:
                      show: true
                      cpu: true
                      memory: true
                      showLabel: true
                - search:
                    provider: google
                    target: _blank
              kubernetes:
                mode: cluster
            # The service account is necessary to allow discovery of other services
            serviceAccount:
              create: true
              name: homepage

            # This enables the service account to access the necessary resources
            enableRbac: true
            ingress:
              main:
                enabled: true
                annotations:
                  # Example annotations to add Homepage to your Homepage!
                  gethomepage.dev/enabled: "true"
                  gethomepage.dev/name: "Homepage"
                  gethomepage.dev/description: "Dynamically Detected Homepage"
                  gethomepage.dev/group: "Dynamic"
                  gethomepage.dev/icon: "homepage.png"
                  traefik.ingress.kubernetes.io/router.entrypoints: websecure
                  traefik.ingress.kubernetes.io/router.tls: 'true'
                  ingress.kubernetes.io/force-ssl-redirect: "true"
                tls:
                  - secretName: istio-cert
                    hosts:
                    -  kube.msbarbieri.dev
                hosts:
                  - host: kube.msbarbieri.dev
                    paths:
                      - path: /
                        pathType: Prefix
